# 快速开始：视频自动分割与并行字幕生成

## 🚀 立即使用

### 1. 安装依赖

```bash
npm install
```

这会自动安装新增的 FFmpeg.wasm 依赖。

### 2. 启动应用

```bash
npm run dev
```

### 3. 使用功能

1. **导入视频**：选择一个 3 分钟以上的视频文件
2. **生成字幕**：点击"生成字幕"按钮
3. **自动处理**：系统会自动：
   - 检测视频时长
   - 分割成 2 分钟片段
   - 并行生成字幕（3 个片段同时处理）
   - 合并完整字幕

## ⚡ 性能对比

### 示例：10 分钟视频

**标准处理**:
```
总耗时: ~5 分钟
进度: [████████████████████] 100%
```

**并行处理（新功能）**:
```
分割视频: [████] 20% (30秒)
批次 1/2: [████████] 40% (1分钟)
批次 2/2: [████████] 40% (1分钟)
合并字幕: [████] 5% (5秒)
总耗时: ~2 分钟 ⚡ 提速 2.5x
```

## 🎯 工作原理

```
长视频 (10分钟)
    ↓
自动分割成 5 个片段 (每个 2 分钟)
    ↓
批次 1: 片段 1, 2, 3 并行处理 ⚡
批次 2: 片段 4, 5 并行处理 ⚡
    ↓
合并字幕 → 完整输出
```

## 📊 适用场景

| 视频时长 | 处理方式 | 预计时间 |
|---------|---------|---------|
| < 3 分钟 | 标准处理 | ~1 分钟 |
| 3-10 分钟 | 自动分割 + 并行 | ~2 分钟 |
| 10-30 分钟 | 自动分割 + 并行 | ~5 分钟 |
| > 30 分钟 | 自动分割 + 并行 | ~10 分钟 |

## 🔧 自定义配置

### 调整并行度

编辑 `services/videoProcessingService.ts`:

```typescript
maxParallelTasks: 3  // 改为 2-5 之间的值
```

**建议值**:
- `2`: 低配设备，节省内存
- `3`: 默认，平衡性能和资源（推荐）
- `4-5`: 高配设备，最快速度

### 调整分割时长

编辑 `services/videoSplitterService.ts`:

```typescript
const TARGET_SEGMENT_DURATION = 120; // 改为 60-300 秒
```

## ⚠️ 注意事项

### 首次使用
- FFmpeg.wasm 首次加载需要下载 ~30MB
- 请确保网络连接正常
- 加载完成后会自动缓存

### 浏览器要求
- Chrome 57+
- Firefox 52+
- Safari 11+
- Edge 16+

### 视频限制
- 单个文件 < 2GB
- 支持常见格式：MP4, MOV, AVI, MKV

## 🐛 常见问题

### Q: FFmpeg 加载失败？
**A**: 检查网络连接，清除浏览器缓存重试。系统会自动降级到标准处理。

### Q: 内存不足？
**A**: 
1. 关闭其他标签页
2. 降低并行度（改为 2 或 1）
3. 使用较小的视频文件

### Q: 字幕不连贯？
**A**: 这是正常的，系统会自动调整时间戳确保连贯性。

### Q: 处理速度没有提升？
**A**: 
1. 确认视频 > 3 分钟（短视频不会分割）
2. 检查控制台日志确认分割已启用
3. 网络速度可能影响 API 调用

## 📝 查看日志

打开浏览器控制台（F12）查看详细日志：

```
Video: 600.0s, will split into 5 segments of ~120s each
Successfully split video into 5 segments
Processing batch 1/2 (3 segments)
Segment 0 progress: 80%
Segment 1 progress: 75%
Segment 2 progress: 85%
Completed segment 1/5 with 45 subtitle entries
...
```

## 🎉 享受快速字幕生成！

有问题？查看完整文档：[VIDEO_SEGMENTATION.md](./VIDEO_SEGMENTATION.md)
